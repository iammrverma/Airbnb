<% layout("/layouts/boilerplate")%>
<div class="listing">
  <div class="row">
    <div class="col-8 offset-3">
      <h3>Listing</h3>
    </div>
    <div class="card col-6 offset-3">
      <img src="<%=listing.image.url%>" alt="..." class="card-img-top" />
      <div class="card-body">
        <h3><%=listing.title%></h3>
        <p class="car-text"><%=listing.description%></p>
        <div class="">
          <span><%=listing.location%></span>,
          <span><%=listing.country%></span>
        </div>
        <p>&#8377; <%= listing.price.toLocaleString("en-IN") %></p>
      </div>
    </div>
  </div>
  <div class="options">
    <a
      href="http://localhost:3000/listings/<%=listing._id%>/edit"
      class="btn btn-dark col-2 offset-3"
      >Edit</a
    >
    <form method="post" action="/listings/<%=listing._id%>?_method=DELETE">
      <button class="btn offset-5">delete</button>
    </form>
  </div>

  <div class="col-8 offset-3">
    <hr />
    <h4>Your Review is valuable for us</h4>
    <form
      action="/listing/<%=listing.id%>/review"
      method="post"
      class="needs-validation"
      novalidate
    >
      <div class="form-group">
        <label for="rating">Rating</label>
        <input
          required
          type="range"
          min="1"
          max="5"
          name="review[rating]"
          id="rating"
          class="form-range"
        />
        <div class="small">Adjust this Slider for 1-5</div>
      </div>
      <div class="form-group">
        <label for="comment" class="form-label">Comment</label>
        <textarea
          rows="5"
          name="review[comment]"
          id="comment"
          class="form-control"
          placeholder="Describe what you liked about this place"
          required
        ></textarea>
        <div class="invalid-feedback">Please describe what your feelings</div>
      </div>

      <button class="btn btn-dark">Publish</button>
    </form>
    <hr />
    <h4>All reviews</h4>
    <div class="row">
      <% for(review of listing.reviews){%>
      <div class="card col-5 ms-2 mb-2">
        <div class="card-body">
          <h5 class="card-title">Name</h5>
          <div class="card-text"><%=review.comment%></div>
          <div class="card-text"><%=review.rating%></div>
          <form
            action="/listing/<%=listing._id%>/review/<%=review._id%>?_method=delete"
            method="post"
          >
            <button class="btn">Remove Review</button>
          </form>
        </div>
      </div>
      <%}%>
    </div>
  </div>
</div>
